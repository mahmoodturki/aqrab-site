<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة تبادل المشاهدات - نظام النقاط</title>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #7209b7;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #4cc9f0;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .points-badge {
            background: var(--accent);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
            margin: 30px 0;
        }
        
        .videos-section h2, .points-section h2 {
            margin-bottom: 20px;
            color: var(--secondary);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }
        
        .videos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .video-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .video-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        .video-thumbnail {
            position: relative;
            height: 180px;
            overflow: hidden;
        }
        
        .video-thumbnail iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .video-info {
            padding: 15px;
        }
        
        .video-title {
            font-weight: 600;
            margin-bottom: 10px;
            height: 40px;
            overflow: hidden;
        }
        
        .watch-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        
        .watch-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }
        
        .watch-btn:hover {
            background: var(--secondary);
        }
        
        .watch-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .timer-display {
            font-size: 0.9rem;
            color: #666;
        }
        
        .points-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            height: fit-content;
        }
        
        .points-info {
            background: #f0f7ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .points-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent);
            text-align: center;
            margin: 10px 0;
        }
        
        .points-rules {
            margin-top: 20px;
        }
        
        .points-rules h3 {
            margin-bottom: 10px;
            color: var(--secondary);
        }
        
        .points-rules ul {
            padding-right: 20px;
        }
        
        .points-rules li {
            margin-bottom: 8px;
        }
        
        .progress-bar {
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: var(--success);
            width: 0%;
            transition: width 0.5s;
        }
        
        footer {
            background: var(--dark);
            color: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 50px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .videos-grid {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">منصة تبادل المشاهدات</div>
                <div class="user-info">
                    <div class="user-name">مستخدم جديد</div>
                    <div class="points-badge">
                        <span id="total-points">0</span> نقطة
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="main-content">
            <section class="videos-section">
                <h2>الفيديوهات المتاحة للمشاهدة</h2>
                <div class="videos-grid" id="videos-container">
                    <!-- سيتم إضافة الفيديوهات ديناميكيًا -->
                </div>
            </section>
            
            <aside class="points-section">
                <h2>نظام النقاط</h2>
                <div class="points-info">
                    <p>رصيدك الحالي من النقاط:</p>
                    <div class="points-value" id="points-display">0 نقطة</div>
                    <p>شاهد الفيديوهات لجمع النقاط!</p>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress" id="watch-progress"></div>
                    </div>
                    <div class="timer-display" id="session-timer">لم تبدأ الجلسة بعد</div>
                </div>
                
                <div class="points-rules">
                    <h3>كيفية جمع النقاط:</h3>
                    <ul>
                        <li>5 نقاط لكل 5 دقائق مشاهدة</li>
                        <li>25 نقطة لكل 25 دقيقة مشاهدة</li>
                        <li>50 نقطة لكل 50 دقيقة مشاهدة</li>
                        <li>يجب مشاهدة الفيديو كاملاً لتحصيل النقاط</li>
                    </ul>
                </div>
            </aside>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>منصة تبادل المشاهدات بالنقاط &copy; 2023 - جميع الحقوق محفوظة</p>
        </div>
    </footer>

    <script>
        // بيانات الفيديوهات الثابتة
        const videos = [
            {
                id: 1,
                title: "فيديو تعليمي 1",
                url: "https://www.youtube.com/embed/3qCGFxc2yEg",
                duration: 300, // 5 دقائق بالثواني
                points: 5
            },
            {
                id: 2,
                title: "فيديو تعليمي 2", 
                url: "https://www.youtube.com/embed/_JXPY08yg8s",
                duration: 600, // 10 دقائق
                points: 10
            },
            {
                id: 3,
                title: "فيديو تعليمي 3",
                url: "https://www.youtube.com/embed/jUZgDM8Oeio", 
                duration: 450, // 7.5 دقائق
                points: 7
            },
            {
                id: 4,
                title: "فيديو تعليمي 4",
                url: "https://www.youtube.com/embed/GMHJdUJRxXQ",
                duration: 900, // 15 دقيقة
                points: 15
            },
            {
                id: 5,
                title: "فيديو تعليمي 5",
                url: "https://www.youtube.com/embed/cmtA4SBYk6g",
                duration: 720, // 12 دقيقة
                points: 12
            },
            {
                id: 6,
                title: "فيديو تعليمي 6",
                url: "https://www.youtube.com/embed/DxQlbEghEek",
                duration: 600, // 10 دقائق
                points: 10
            },
            {
                id: 7,
                title: "فيديو تعليمي 7",
                url: "https://www.youtube.com/embed/shZyR0a-ODE",
                duration: 480, // 8 دقائق
                points: 8
            },
            {
                id: 8,
                title: "فيديو تعليمي 8",
                url: "https://www.youtube.com/embed/7vUrwQ4QcW8",
                duration: 540, // 9 دقائق
                points: 9
            }
        ];

        // حالة المستخدم
        let userState = {
            points: 0,
            currentVideo: null,
            watchTime: 0,
            watchedVideos: new Set(),
            timerInterval: null
        };

        // DOM Elements
        const videosContainer = document.getElementById('videos-container');
        const totalPointsElement = document.getElementById('total-points');
        const pointsDisplay = document.getElementById('points-display');
        const watchProgress = document.getElementById('watch-progress');
        const sessionTimer = document.getElementById('session-timer');

        // تهيئة الفيديوهات في الواجهة
        function initializeVideos() {
            videosContainer.innerHTML = '';
            
            videos.forEach(video => {
                const videoCard = document.createElement('div');
                videoCard.className = 'video-card';
                videoCard.innerHTML = `
                    <div class="video-thumbnail">
                        <iframe src="${video.url}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    <div class="video-info">
                        <div class="video-title">${video.title}</div>
                        <div class="video-duration">المدة: ${Math.floor(video.duration / 60)} دقيقة</div>
                        <div class="video-points">النقاط: ${video.points}</div>
                        <div class="watch-controls">
                            <button class="watch-btn" data-id="${video.id}" ${userState.watchedVideos.has(video.id) ? 'disabled' : ''}>
                                ${userState.watchedVideos.has(video.id) ? 'تمت المشاهدة' : 'بدء المشاهدة'}
                            </button>
                            <div class="timer-display" id="timer-${video.id}">--:--</div>
                        </div>
                    </div>
                `;
                
                videosContainer.appendChild(videoCard);
            });
            
            // إضافة مستمعي الأحداث للأزرار
            document.querySelectorAll('.watch-btn').forEach(btn => {
                btn.addEventListener('click', handleWatchButtonClick);
            });
        }

        // التعامل مع النقر على زر المشاهدة
        function handleWatchButtonClick(e) {
            const videoId = parseInt(e.target.getAttribute('data-id'));
            const video = videos.find(v => v.id === videoId);
            
            if (!video || userState.watchedVideos.has(videoId)) return;
            
            // إذا كان هناك فيديو قيد المشاهدة حالياً، أوقفه
            if (userState.currentVideo) {
                stopWatching();
            }
            
            // بدء مشاهدة الفيديو الجديد
            startWatching(video);
        }

        // بدء مشاهدة فيديو
        function startWatching(video) {
            userState.currentVideo = video;
            userState.watchTime = 0;
            
            // تحديث واجهة المستخدم
            const watchBtn = document.querySelector(`.watch-btn[data-id="${video.id}"]`);
            watchBtn.textContent = 'جاري المشاهدة...';
            watchBtn.disabled = true;
            
            // بدء المؤقت
            userState.timerInterval = setInterval(() => {
                userState.watchTime++;
                
                // تحديث المؤقت المرئي
                const timerDisplay = document.getElementById(`timer-${video.id}`);
                const remaining = video.duration - userState.watchTime;
                const minutes = Math.floor(remaining / 60);
                const seconds = remaining % 60;
                timerDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                // تحديث شريط التقدم
                const progress = (userState.watchTime / video.duration) * 100;
                watchProgress.style.width = `${progress}%`;
                
                // تحديث مؤشر الجلسة
                sessionTimer.textContent = `متبقي: ${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                // إذا اكتملت المدة
                if (userState.watchTime >= video.duration) {
                    completeWatching(video);
                }
            }, 1000);
        }

        // إكمال مشاهدة الفيديو
        function completeWatching(video) {
            clearInterval(userState.timerInterval);
            
            // منح النقاط للمستخدم
            userState.points += video.points;
            userState.watchedVideos.add(video.id);
            
            // تحديث واجهة المستخدم
            updatePointsDisplay();
            
            // إعادة تعيين حالة المشاهدة
            userState.currentVideo = null;
            userState.watchTime = 0;
            
            // إعادة تعيين شريط التقدم والمؤقت
            watchProgress.style.width = '0%';
            sessionTimer.textContent = 'اكتملت المشاهدة!';
            
            // إعادة تهيئة الفيديوهات لتحديث الأزرار
            setTimeout(() => {
                initializeVideos();
                sessionTimer.textContent = 'يمكنك بدء مشاهدة فيديو آخر';
            }, 2000);
            
            // عرض رسالة نجاح
            alert(`مبروك! لقد كسبت ${video.points} نقطة من مشاهدة "${video.title}"`);
        }

        // إيقاف المشاهدة
        function stopWatching() {
            if (userState.timerInterval) {
                clearInterval(userState.timerInterval);
            }
            
            if (userState.currentVideo) {
                const watchBtn = document.querySelector(`.watch-btn[data-id="${userState.currentVideo.id}"]`);
                if (watchBtn) {
                    watchBtn.textContent = 'بدء المشاهدة';
                    watchBtn.disabled = false;
                }
                
                const timerDisplay = document.getElementById(`timer-${userState.currentVideo.id}`);
                if (timerDisplay) {
                    timerDisplay.textContent = '--:--';
                }
            }
            
            userState.currentVideo = null;
            userState.watchTime = 0;
            watchProgress.style.width = '0%';
            sessionTimer.textContent = 'توقفت المشاهدة';
        }

        // تحديث عرض النقاط
        function updatePointsDisplay() {
            totalPointsElement.textContent = userState.points;
            pointsDisplay.textContent = `${userState.points} نقطة`;
        }

        // التهيئة عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', () => {
            initializeVideos();
            updatePointsDisplay();
        });
    </script>
</body>
</html>
