<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProductShow - Ù…Ù†ØµØ© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</title>
    <style>
        /* Ø£Ù†Ù…Ø§Ø· CSS */
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .ad-top {
            width: 100%;
            text-align: center;
            background-color: #f8f9fa;
            padding: 10px 0;
            border-bottom: 1px solid #ddd;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Ø±Ø£Ø³ Ø§Ù„Ù…ÙˆÙ‚Ø¹ */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .nav-links {
            display: flex;
            gap: 20px;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--dark-color);
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: var(--primary-color);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            background-size: cover;
            background-position: center;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #2980b9;
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover {
            background-color: var(--primary-color);
            color: white;
        }

        /* Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .login-form {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .avatar-upload {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .avatar-preview {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: #eee;
            background-size: cover;
            background-position: center;
            border: 2px solid #ddd;
        }

        .form-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        /* Ù‚Ø³Ù… Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ */
        .add-product {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .add-product h2 {
            margin-bottom: 15px;
            color: var(--dark-color);
        }

        .product-form input,
        .product-form textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .product-form textarea {
            min-height: 100px;
            resize: vertical;
        }

        .image-upload {
            margin-bottom: 15px;
        }

        .image-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .preview-img {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        /* Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª */
        .posts-section {
            margin-bottom: 30px;
        }

        .posts-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .sort-options select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        /* Ù…Ù†Ø´ÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬ */
        .product-post {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 25px;
            overflow: hidden;
        }

        .post-header {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }

        .post-user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-left: 10px;
            background-size: cover;
            background-position: center;
        }

        .post-user-info h4 {
            font-size: 16px;
            margin-bottom: 2px;
        }

        .post-user-info span {
            font-size: 12px;
            color: #777;
        }

        .post-content {
            padding: 15px;
        }

        .post-title {
            font-size: 20px;
            margin-bottom: 10px;
            color: var(--dark-color);
        }

        .post-description {
            margin-bottom: 15px;
            color: #555;
        }

        .post-images {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .post-image {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            max-height: 300px;
        }

        .post-stats {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #777;
            margin-bottom: 10px;
        }

        .post-actions {
            display: flex;
            border-top: 1px solid #eee;
        }

        .post-action {
            flex: 1;
            text-align: center;
            padding: 12px 0;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .post-action:hover {
            background-color: #f5f5f5;
        }

        .post-action.liked {
            color: var(--danger-color);
        }

        .star-rating {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }

        .star {
            color: #ddd;
            cursor: pointer;
            font-size: 20px;
        }

        .star.active {
            color: var(--warning-color);
        }

        .post-link {
            display: block;
            margin-top: 10px;
            color: var(--primary-color);
            text-decoration: none;
            font-size: 14px;
        }

        /* Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª */
        .ad-middle {
            width: 100%;
            text-align: center;
            margin: 30px 0;
            padding: 20px 0;
            background-color: #f8f9fa;
            border-radius: 8px;
        }

        /* Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ */
        .site-stats {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 14px;
            color: #777;
        }

        /* ØªØ°ÙŠÙŠÙ„ Ø§Ù„ØµÙØ­Ø© */
        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 30px 0;
            text-align: center;
            margin-top: 50px;
        }

        /* ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }

            .nav-links {
                gap: 10px;
            }

            .site-stats {
                flex-direction: column;
                gap: 15px;
            }

            .post-actions {
                flex-wrap: wrap;
            }

            .post-action {
                flex: 0 0 33.33%;
            }
        }
    </style>
</head>
<body>
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
    <div class="ad-top">
        <script type="text/javascript">
            atOptions = {
                'key' : '2d5deaded3e62ebc9943db8d8b49f74e',
                'format' : 'iframe',
                'height' : 50,
                'width' : 320,
                'params' : {}
            };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/2d5deaded3e62ebc9943db8d8b49f74e/invoke.js"></script>
    </div>

    <!-- Ø±Ø£Ø³ Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">ProductShow</div>
                <nav class="nav-links">
                    <a href="#">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                    <a href="#">Ø§Ø³ØªÙƒØ´Ù</a>
                    <a href="#">Ø§Ù„ÙØ¦Ø§Øª</a>
                    <a href="#">Ø§Ù„Ù…ÙØ¶Ù„Ø©</a>
                </nav>
                <div class="user-section">
                    <div class="site-visits">
                        <span id="visit-count">0</span> Ø²Ø§Ø¦Ø±
                    </div>
                    <div id="user-info" style="display: none;">
                        <div class="user-avatar" id="user-avatar">Ù…</div>
                        <span id="username">Ù…Ø³ØªØ®Ø¯Ù…</span>
                        <button class="btn btn-outline" id="logout-btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
                    </div>
                    <button class="btn btn-primary" id="login-btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div class="login-modal" id="login-modal">
        <div class="login-form">
            <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
            <div class="form-group">
                <label for="login-username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                <input type="text" id="login-username" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            </div>
            <div class="form-group">
                <label>ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„</label>
                <div class="avatar-upload">
                    <div class="avatar-preview" id="avatar-preview"></div>
                    <input type="file" id="avatar-upload" accept="image/*">
                </div>
            </div>
            <div class="form-actions">
                <button class="btn btn-outline" id="cancel-login">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="btn btn-primary" id="submit-login">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
        <div class="site-stats">
            <div class="stat-item">
                <div class="stat-value" id="total-posts">0</div>
                <div class="stat-label">Ù…Ù†ØªØ¬ Ù…Ø¹Ø±ÙˆØ¶</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="total-likes">0</div>
                <div class="stat-label">Ø¥Ø¹Ø¬Ø§Ø¨</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="total-comments">0</div>
                <div class="stat-label">ØªØ¹Ù„ÙŠÙ‚</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="total-shares">0</div>
                <div class="stat-label">Ù…Ø´Ø§Ø±ÙƒØ©</div>
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ -->
        <section class="add-product" id="add-product-section" style="display: none;">
            <h2>Ø£Ø¶Ù Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h2>
            <form class="product-form" id="product-form">
                <input type="text" id="product-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" required>
                <textarea id="product-description" placeholder="ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬" required></textarea>
                <div class="image-upload">
                    <label for="product-images">Ø¥Ø¶Ø§ÙØ© ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬</label>
                    <input type="file" id="product-images" multiple accept="image/*">
                    <div class="image-preview" id="image-preview"></div>
                </div>
                <button type="submit" class="btn btn-primary">Ù†Ø´Ø± Ø§Ù„Ù…Ù†ØªØ¬</button>
            </form>
        </section>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª -->
        <section class="posts-section">
            <div class="posts-header">
                <h2>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©</h2>
                <div class="sort-options">
                    <select id="sort-posts">
                        <option value="popular">Ø§Ù„Ø£ÙƒØ«Ø± ØªÙØ§Ø¹Ù„Ø§Ù‹</option>
                        <option value="recent">Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹</option>
                    </select>
                </div>
            </div>

            <div id="posts-container">
                <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>

            <!-- Ø¥Ø¹Ù„Ø§Ù† ÙˆØ³Ø· Ø§Ù„ØµÙØ­Ø© -->
            <div class="ad-middle">
                <script type="text/javascript">
                    atOptions = {
                        'key' : '2d5deaded3e62ebc9943db8d8b49f74e',
                        'format' : 'iframe',
                        'height' : 50,
                        'width' : 320,
                        'params' : {}
                    };
                </script>
                <script type="text/javascript" src="//www.highperformanceformat.com/2d5deaded3e62ebc9943db8d8b49f74e/invoke.js"></script>
            </div>
        </section>
    </div>

    <!-- ØªØ°ÙŠÙŠÙ„ Ø§Ù„ØµÙØ­Ø© -->
    <footer>
        <div class="container">
            <p>ProductShow &copy; 2023 - Ù…Ù†ØµØ© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆÙ…Ø´Ø§Ø±ÙƒØªÙ‡Ø§ Ù…Ø¹ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†</p>
        </div>
    </footer>

    <script>
        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù…ØªØºÙŠØ±Ø§Øª
        let currentUser = null;
        let posts = JSON.parse(localStorage.getItem('posts')) || [];
        let visitCount = parseInt(localStorage.getItem('visitCount')) || 0;

        // Ø¹Ù†Ø§ØµØ± DOM
        const loginBtn = document.getElementById('login-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const loginModal = document.getElementById('login-modal');
        const cancelLogin = document.getElementById('cancel-login');
        const submitLogin = document.getElementById('submit-login');
        const userInfo = document.getElementById('user-info');
        const userAvatar = document.getElementById('user-avatar');
        const usernameSpan = document.getElementById('username');
        const addProductSection = document.getElementById('add-product-section');
        const productForm = document.getElementById('product-form');
        const postsContainer = document.getElementById('posts-container');
        const sortPosts = document.getElementById('sort-posts');
        const visitCountSpan = document.getElementById('visit-count');
        const totalPostsSpan = document.getElementById('total-posts');
        const totalLikesSpan = document.getElementById('total-likes');
        const totalCommentsSpan = document.getElementById('total-comments');
        const totalSharesSpan = document.getElementById('total-shares');
        const productImagesInput = document.getElementById('product-images');
        const imagePreview = document.getElementById('image-preview');
        const avatarUpload = document.getElementById('avatar-upload');
        const avatarPreview = document.getElementById('avatar-preview');

        // Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
        visitCount++;
        localStorage.setItem('visitCount', visitCount);
        visitCountSpan.textContent = visitCount;

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStats() {
            totalPostsSpan.textContent = posts.length;
            
            let totalLikes = 0;
            let totalComments = 0;
            let totalShares = 0;
            
            posts.forEach(post => {
                totalLikes += post.likes;
                totalComments += post.comments.length;
                totalShares += post.shares;
            });
            
            totalLikesSpan.textContent = totalLikes;
            totalCommentsSpan.textContent = totalComments;
            totalSharesSpan.textContent = totalShares;
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function checkUserStatus() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showUserInfo();
            }
        }

        // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function showUserInfo() {
            loginBtn.style.display = 'none';
            userInfo.style.display = 'flex';
            usernameSpan.textContent = currentUser.username;
            
            if (currentUser.avatar) {
                userAvatar.style.backgroundImage = `url(${currentUser.avatar})`;
                userAvatar.textContent = '';
            } else {
                userAvatar.style.backgroundImage = 'none';
                userAvatar.textContent = currentUser.username.charAt(0).toUpperCase();
            }
            
            addProductSection.style.display = 'block';
        }

        // Ø¥Ø®ÙØ§Ø¡ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function hideUserInfo() {
            loginBtn.style.display = 'block';
            userInfo.style.display = 'none';
            addProductSection.style.display = 'none';
            currentUser = null;
            localStorage.removeItem('currentUser');
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function login() {
            const username = document.getElementById('login-username').value;
            
            if (username) {
                currentUser = {
                    username: username,
                    avatar: avatarPreview.style.backgroundImage || null
                };
                
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                showUserInfo();
                closeLoginModal();
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø­Ù‚ÙˆÙ„
                document.getElementById('login-username').value = '';
                avatarPreview.style.backgroundImage = '';
                avatarUpload.value = '';
            } else {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
            }
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        function logout() {
            hideUserInfo();
        }

        // ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function openLoginModal() {
            loginModal.style.display = 'flex';
        }

        function closeLoginModal() {
            loginModal.style.display = 'none';
        }

        // Ù…Ø¹Ø§ÙŠÙ†Ø© ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„
        avatarUpload.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    avatarPreview.style.backgroundImage = `url(${e.target.result})`;
                }
                
                reader.readAsDataURL(file);
            }
        });

        // Ù…Ø¹Ø§ÙŠÙ†Ø© ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬ Ù‚Ø¨Ù„ Ø§Ù„Ø±ÙØ¹
        productImagesInput.addEventListener('change', function() {
            imagePreview.innerHTML = '';
            const files = this.files;
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'preview-img';
                    imagePreview.appendChild(img);
                }
                
                reader.readAsDataURL(file);
            }
        });

        // Ù†Ø´Ø± Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯
        function addProduct(e) {
            e.preventDefault();
            
            if (!currentUser) {
                alert('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const productName = document.getElementById('product-name').value;
            const productDescription = document.getElementById('product-description').value;
            const productImages = document.getElementById('product-images').files;
            
            if (!productName || !productDescription) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                return;
            }
            
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ± Ø¥Ù„Ù‰ base64
            const images = [];
            const readers = [];
            
            if (productImages.length > 0) {
                for (let i = 0; i < productImages.length; i++) {
                    const reader = new FileReader();
                    readers.push(reader);
                    
                    reader.onload = function(e) {
                        images.push(e.target.result);
                        
                        // Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡ÙŠÙ†Ø§ Ù…Ù† Ù‚Ø±Ø§Ø¡Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ±ØŒ Ù†Ù†Ø´Ø¦ Ø§Ù„Ù…Ù†Ø´ÙˆØ±
                        if (images.length === productImages.length) {
                            createPost(productName, productDescription, images);
                        }
                    }
                    
                    reader.readAsDataURL(productImages[i]);
                }
            } else {
                createPost(productName, productDescription, []);
            }
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø´ÙˆØ± Ø¬Ø¯ÙŠØ¯
        function createPost(name, description, images) {
            const newPost = {
                id: Date.now(),
                productName: name,
                description: description,
                images: images,
                author: currentUser.username,
                authorAvatar: currentUser.avatar,
                likes: 0,
                comments: [],
                shares: 0,
                rating: 0,
                ratingsCount: 0,
                timestamp: new Date().toISOString(),
                liked: false
            };
            
            posts.unshift(newPost);
            localStorage.setItem('posts', JSON.stringify(posts));
            renderPosts();
            updateStats();
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            productForm.reset();
            imagePreview.innerHTML = '';
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª
        function renderPosts() {
            postsContainer.innerHTML = '';
            
            // ÙØ±Ø² Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
            let sortedPosts = [...posts];
            
            if (sortPosts.value === 'popular') {
                sortedPosts.sort((a, b) => {
                    const aScore = a.likes + a.comments.length + a.shares;
                    const bScore = b.likes + b.comments.length + b.shares;
                    return bScore - aScore;
                });
            } else {
                sortedPosts.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            }
            
            sortedPosts.forEach(post => {
                const postElement = createPostElement(post);
                postsContainer.appendChild(postElement);
            });
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ù…Ù†Ø´ÙˆØ±
        function createPostElement(post) {
            const postDiv = document.createElement('div');
            postDiv.className = 'product-post';
            postDiv.dataset.id = post.id;
            
            // Ø±Ø£Ø³ Ø§Ù„Ù…Ù†Ø´ÙˆØ±
            const postHeader = document.createElement('div');
            postHeader.className = 'post-header';
            
            const userAvatar = document.createElement('div');
            userAvatar.className = 'post-user-avatar';
            
            if (post.authorAvatar) {
                userAvatar.style.backgroundImage = post.authorAvatar;
            } else {
                userAvatar.textContent = post.author.charAt(0).toUpperCase();
            }
            
            const userInfo = document.createElement('div');
            userInfo.className = 'post-user-info';
            
            const userName = document.createElement('h4');
            userName.textContent = post.author;
            
            const postDate = document.createElement('span');
            postDate.textContent = new Date(post.timestamp).toLocaleDateString('ar-SA');
            
            userInfo.appendChild(userName);
            userInfo.appendChild(postDate);
            
            postHeader.appendChild(userAvatar);
            postHeader.appendChild(userInfo);
            
            // Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø´ÙˆØ±
            const postContent = document.createElement('div');
            postContent.className = 'post-content';
            
            const postTitle = document.createElement('h3');
            postTitle.className = 'post-title';
            postTitle.textContent = post.productName;
            
            const postDescription = document.createElement('p');
            postDescription.className = 'post-description';
            postDescription.textContent = post.description;
            
            postContent.appendChild(postTitle);
            postContent.appendChild(postDescription);
            
            // ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬
            if (post.images && post.images.length > 0) {
                const postImages = document.createElement('div');
                postImages.className = 'post-images';
                
                post.images.forEach(imageSrc => {
                    const img = document.createElement('img');
                    img.src = imageSrc;
                    img.className = 'post-image';
                    postImages.appendChild(img);
                });
                
                postContent.appendChild(postImages);
            }
            
            // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù†Ø´ÙˆØ±
            const postStats = document.createElement('div');
            postStats.className = 'post-stats';
            
            const likesCount = document.createElement('span');
            likesCount.textContent = `${post.likes} Ø¥Ø¹Ø¬Ø§Ø¨`;
            
            const commentsCount = document.createElement('span');
            commentsCount.textContent = `${post.comments.length} ØªØ¹Ù„ÙŠÙ‚`;
            
            const sharesCount = document.createElement('span');
            sharesCount.textContent = `${post.shares} Ù…Ø´Ø§Ø±ÙƒØ©`;
            
            postStats.appendChild(likesCount);
            postStats.appendChild(commentsCount);
            postStats.appendChild(sharesCount);
            
            postContent.appendChild(postStats);
            
            // ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ø¬ÙˆÙ…
            const starRating = document.createElement('div');
            starRating.className = 'star-rating';
            
            for (let i = 1; i <= 5; i++) {
                const star = document.createElement('span');
                star.className = 'star';
                star.innerHTML = 'â˜…';
                star.dataset.rating = i;
                
                if (i <= Math.floor(post.rating)) {
                    star.classList.add('active');
                }
                
                star.addEventListener('click', () => ratePost(post.id, i));
                starRating.appendChild(star);
            }
            
            const ratingText = document.createElement('span');
            ratingText.textContent = `(${post.ratingsCount})`;
            ratingText.style.marginRight = '10px';
            starRating.appendChild(ratingText);
            
            postContent.appendChild(starRating);
            
            // Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù†Ø´ÙˆØ±
            const postLink = document.createElement('a');
            postLink.href = `#post-${post.id}`;
            postLink.className = 'post-link';
            postLink.textContent = 'Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù†Ø´ÙˆØ±';
            postContent.appendChild(postLink);
            
            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„
            const postActions = document.createElement('div');
            postActions.className = 'post-actions';
            
            const likeBtn = document.createElement('div');
            likeBtn.className = `post-action ${post.liked ? 'liked' : ''}`;
            likeBtn.innerHTML = `<span>ğŸ‘</span> Ø¥Ø¹Ø¬Ø§Ø¨`;
            likeBtn.addEventListener('click', () => toggleLike(post.id));
            
            const commentBtn = document.createElement('div');
            commentBtn.className = 'post-action';
            commentBtn.innerHTML = `<span>ğŸ’¬</span> ØªØ¹Ù„ÙŠÙ‚`;
            commentBtn.addEventListener('click', () => addComment(post.id));
            
            const shareBtn = document.createElement('div');
            shareBtn.className = 'post-action';
            shareBtn.innerHTML = `<span>ğŸ”„</span> Ù…Ø´Ø§Ø±ÙƒØ©`;
            shareBtn.addEventListener('click', () => sharePost(post.id));
            
            postActions.appendChild(likeBtn);
            postActions.appendChild(commentBtn);
            postActions.appendChild(shareBtn);
            
            // ØªØ¬Ù…ÙŠØ¹ ÙƒÙ„ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡
            postDiv.appendChild(postHeader);
            postDiv.appendChild(postContent);
            postDiv.appendChild(postActions);
            
            return postDiv;
        }

        // ØªÙØ¹ÙŠÙ„/Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨
        function toggleLike(postId) {
            if (!currentUser) {
                alert('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const postIndex = posts.findIndex(p => p.id === postId);
            if (postIndex !== -1) {
                if (posts[postIndex].liked) {
                    posts[postIndex].likes--;
                    posts[postIndex].liked = false;
                } else {
                    posts[postIndex].likes++;
                    posts[postIndex].liked = true;
                }
                
                localStorage.setItem('posts', JSON.stringify(posts));
                renderPosts();
                updateStats();
            }
        }

        // Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚
        function addComment(postId) {
            if (!currentUser) {
                alert('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const commentText = prompt('Ø£Ø¯Ø®Ù„ ØªØ¹Ù„ÙŠÙ‚Ùƒ:');
            if (commentText) {
                const postIndex = posts.findIndex(p => p.id === postId);
                if (postIndex !== -1) {
                    posts[postIndex].comments.push({
                        user: currentUser.username,
                        text: commentText,
                        timestamp: new Date().toISOString()
                    });
                    
                    localStorage.setItem('posts', JSON.stringify(posts));
                    renderPosts();
                    updateStats();
                }
            }
        }

        // Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†Ø´ÙˆØ±
        function sharePost(postId) {
            if (!currentUser) {
                alert('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const postIndex = posts.findIndex(p => p.id === postId);
            if (postIndex !== -1) {
                posts[postIndex].shares++;
                localStorage.setItem('posts', JSON.stringify(posts));
                renderPosts();
                updateStats();
                
                // ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© Ù…Ø´Ø§Ø±ÙƒØ© Ø­Ù‚ÙŠÙ‚ÙŠØ©
                alert('ØªÙ…Øª Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†Ø´ÙˆØ±!');
            }
        }

        // ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ù†Ø´ÙˆØ±
        function ratePost(postId, rating) {
            if (!currentUser) {
                alert('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const postIndex = posts.findIndex(p => p.id === postId);
            if (postIndex !== -1) {
                // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯
                const totalRating = posts[postIndex].rating * posts[postIndex].ratingsCount;
                posts[postIndex].ratingsCount++;
                posts[postIndex].rating = (totalRating + rating) / posts[postIndex].ratingsCount;
                
                localStorage.setItem('posts', JSON.stringify(posts));
                renderPosts();
            }
        }

        // Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        loginBtn.addEventListener('click', openLoginModal);
        cancelLogin.addEventListener('click', closeLoginModal);
        submitLogin.addEventListener('click', login);
        logoutBtn.addEventListener('click', logout);
        productForm.addEventListener('submit', addProduct);
        sortPosts.addEventListener('change', renderPosts);

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        checkUserStatus();
        renderPosts();
        updateStats();

        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
        window.addEventListener('click', (e) => {
            if (e.target === loginModal) {
                closeLoginModal();
            }
        });
    </script>
</body>
</html>
